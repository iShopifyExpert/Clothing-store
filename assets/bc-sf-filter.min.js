var onSale=false;var soldOut=false;var priceVaries=false;var images=[];var firstVariant={};var bcSfFilterSettings={general:{limit:bcSfFilterConfig.custom.products_per_page,loadProductFirst:true}};var bcSfFilterTemplate={soldOutClass:" sold-out",saleClass:" on-sale",soldOutLabelHtml:'<span class="soldout bc-sf-filter-label">'+bcSfFilterConfig.label_basic.sold_out+"</span>",saleLabelHtml:'<span class="sale bc-sf-filter-label">'+bcSfFilterConfig.label_basic.sale+"</span>",tagLabelHtml:'<span class="tag bc-sf-filter-label {{labelTag}}" >{{labelTag}}</span>',vendorHtml:'<p class="bc-sf-filter-product-item-vendor">{{itemVendorLabel}}</p>',productGridItemHtml:'<div class="bc-sf-filter-product-item bc-sf-filter-product-item-grid {{gridWidthClass}}{{soldOutClass}}{{saleClass}} {{itemActiveSwapClass}}"><script class="bc-sf-filter-product-script" data-id="bc-product-json-{{itemId}}" type="application/json">{{itemJson}}<\/script><div class="bc-sf-filter-product-item-inner"><div class="bc-sf-filter-product-item-image"><a href="{{itemUrl}}" class="bc-sf-filter-product-item-image-link">{{itemImages}}</a></div><div class="bc-sf-filter-product-item-label">{{itemLabels}}{{itemTagLabels}}</div><div class="bc-sf-filter-product-bottom"><a href="{{itemUrl}}" class="bc-sf-filter-product-item-title">{{itemTitle}}</a>{{itemVendor}}{{itemPrice}}</div></div></div>',productListItemHtml:'<div class="bc-sf-filter-product-item bc-sf-filter-product-item-list {{soldOutClass}}{{saleClass}} {{itemActiveSwapClass}}"><div class="bc-sf-filter-product-item-list-col-1"><div class="bc-sf-filter-product-item-image"><div class="bc-sf-filter-product-item-label">{{itemLabels}}{{itemTagLabels}}</div><a href="{{itemUrl}}" class="bc-sf-filter-product-item-image-link">{{itemImages}}</a></div></div><div class="bc-sf-filter-product-bottom"><div class="bc-sf-filter-product-item-list-col-2"><a href="{{itemUrl}}" class="bc-sf-filter-product-item-title">{{itemTitle}}</a>{{itemVendor}}<p class="bc-sf-filter-des">{{itemDescription}}</p></div><div class="bc-sf-filter-product-item-list-col-3">{{itemPrice}}</div></div></div>',previousActiveHtml:'<li><a href="{{itemUrl}}">&larr;</a></li>',previousDisabledHtml:'<li class="disabled"><span>&larr;</span></li>',nextActiveHtml:'<li><a href="{{itemUrl}}">&rarr;</a></li>',nextDisabledHtml:'<li class="disabled"><span>&rarr;</span></li>',pageItemHtml:'<li><a href="{{itemUrl}}">{{itemTitle}}</a></li>',pageItemSelectedHtml:'<li><span class="active">{{itemTitle}}</span></li>',pageItemRemainHtml:"<li><span>{{itemTitle}}</span></li>",paginateHtml:"<ul>{{previous}}{{pageItems}}{{next}}</ul>",sortingHtml:"<label>"+bcSfFilterConfig.label.sorting+'</label><select class="bc-sf-filter-filter-dropdown">{{sortingItems}}</select>',showLimitHtml:"<label>"+bcSfFilterConfig.label.show_limit+'</label><select class="bc-sf-filter-filter-dropdown">{{showLimitItems}}</select>',breadcrumbHtml:'<a href="/">'+bcSfFilterConfig.label.breadcrumb_home+"</a> {{breadcrumbDivider}} {{breadcrumbItems}}",breadcrumbDivider:'<span class="divider">/</span>',breadcrumbItemLink:'<a href="{{itemLink}}">{{itemTitle}}</a>',breadcrumbItemSelected:"<span>{{itemTitle}}</span>",};function prepareShopifyData(d){soldOut=!d.available;onSale=d.compare_at_price_min>d.price_min;priceVaries=d.price_min!=d.price_max;images=d.images_info;var c=d.variants[0];if(getParam("variant")!==null&&getParam("variant")!=""){var a=d.variants.filter(function(f){return f.id==getParam("variant")});if(typeof a[0]!=="undefined"){c=a[0]}}else{for(var b=0;b<d.variants.length;b++){if(d.variants[b].available){c=d.variants[b];break}}}return d}BCSfFilter.prototype.buildProductGridItem=function(d,b){var g=bcSfFilterTemplate.productGridItemHtml;d=prepareShopifyData(d);var f=soldOut?bcSfFilterTemplate.soldOutClass:"";var c=onSale?bcSfFilterTemplate.saleClass:"";g=g.replace(/{{soldOutClass}}/g,f);g=g.replace(/{{saleClass}}/g,c);g=g.replace(/{{gridWidthClass}}/g,buildGridWidthClass(d));g=g.replace(/{{itemLabels}}/g,buildLabels(d));g=g.replace(/{{itemTagLabels}}/g,buildTagLabels(d,false));g=g.replace(/{{itemImages}}/g,buildImages(d));g=g.replace(/{{itemPrice}}/g,buildPrice(d));g=g.replace(/{{itemVendor}}/g,buildVendor(d));var a=this;var e={id:d.id,title:d.title,handle:d.handle,vendor:d.vendor,variants:d.variants,url:a.buildProductItemUrl(d),options_with_values:d.options_with_values,images:d.images,available:d.available,price_min:d.price_min,price_max:d.price_max,compare_at_price_min:d.compare_at_price_min,compare_at_price_max:d.compare_at_price_max};g=g.replace(/{{itemJson}}/g,JSON.stringify(e));g=g.replace(/{{itemId}}/g,d.id);g=g.replace(/{{itemTitle}}/g,d.title);g=g.replace(/{{itemHandle}}/g,d.handle);g=g.replace(/{{itemVendorLabel}}/g,d.vendor);g=g.replace(/{{itemUrl}}/g,this.buildProductItemUrl(d));return g};BCSfFilter.prototype.buildProductListItem=function(c){var j=c.images_info;var f=!c.available;var n=c.compare_at_price_min>c.price_min;var k=c.price_min!=c.price_max;var g=c.variants[0];if(getParam("variant")!==null&&getParam("variant")!=""){var l=c.variants.filter(function(i){return i.id==getParam("variant")});if(typeof l[0]!=="undefined"){g=l[0]}}else{for(var d=0;d<c.variants.length;d++){if(c.variants[d].available){g=c.variants[d];break}}}var b=bcSfFilterTemplate.productListItemHtml;c=prepareShopifyData(c);var e=f?bcSfFilterTemplate.soldOutClass:"";var m=n?bcSfFilterTemplate.saleClass:"";b=b.replace(/{{soldOutClass}}/g,e);b=b.replace(/{{saleClass}}/g,m);b=b.replace(/{{itemLabels}}/g,buildLabels(c));b=b.replace(/{{itemTagLabels}}/g,buildTagLabels(c,false));b=b.replace(/{{itemImages}}/g,buildImages(c));b=b.replace(/{{itemVendor}}/g,buildVendor(c));var a=buildPrice(c,n,k);b=b.replace(/{{itemPrice}}/g,a);var h=jQ("<p>"+c.body_html+"</p>").text();h=(h.split(" ")).length>40?h.split(" ").splice(0,40).join(" ")+"...":h.split(" ").splice(0,40).join(" ");b=b.replace(/{{itemDescription}}/g,h);b=b.replace(/{{itemTitle}}/g,c.title);b=b.replace(/{{itemVendorLabel}}/g,c.vendor);b=b.replace(/{{itemUrl}}/g,this.buildProductItemUrl(c));return b};function buildGridWidthClass(){var a="";switch(bcSfFilterConfig.custom.products_per_row){case 2:a="bc-sf-filter-grid-width-2";break;case 3:a="bc-sf-filter-grid-width-3";break;case 5:a="bc-sf-filter-grid-width-5";break;default:a="bc-sf-filter-grid-width-4";break}switch(bcSfFilterConfig.custom.products_per_row_mobile){case 1:a+=" bc-sf-filter-grid-width-mb-1";break;case 3:a+=" bc-sf-filter-grid-width-mb-3";break;default:a+=" bc-sf-filter-grid-width-mb-2";break}return a}function buildImages(b){var a="";var c=images.length>0?bcsffilter.optimizeImage(images[0]["src"]):bcSfFilterConfig.general.no_image_url;a+='<img src="'+c+'" class="bc-sf-filter-product-item-main-image" />';return a}function buildVendor(b){var a="";if(bcSfFilterConfig.custom.show_vendor){a=bcSfFilterTemplate.vendorHtml}return a}function buildPrice(b){var a="";if(bcSfFilterConfig.custom.show_price){a='<p class="bc-sf-filter-product-item-price">';if(onSale){a+="<s>"+bcsffilter.formatMoney(b.compare_at_price_min)+"</s> ";a+='<span class="bc-sf-filter-product-item-sale-price">'+bcsffilter.formatMoney(b.price_min)+"</span>"}else{if(priceVaries){a+=(bcSfFilterConfig.label_basic.from)+" "}a+='<span class="bc-sf-filter-product-item-regular-price">'+bcsffilter.formatMoney(b.price_min)+"</span>"}a+="</p>"}return a}function buildLabels(c){var b="";if(bcSfFilterConfig.custom.show_sold_out_label&&soldOut){b=bcSfFilterTemplate.soldOutLabelHtml.replace(/{{style}}/g,"")}var a="";if(bcSfFilterConfig.custom.show_sale_label&&onSale&&!soldOut){a=bcSfFilterTemplate.saleLabelHtml.replace(/{{style}}/g,"")}return b+a}function buildTagLabels(d,f){if(f){var c="";if(d.tags){for(var b=0;b<d.tags.length;b++){var a=d.tags[b];if(a.indexOf("pfs:label")!==-1){var e=bcSfFilterTemplate.tagLabelHtml.replace(/{{labelTag}}/g,a.split("pfs:label-")[1]);c+=e}}}}else{var c="";if(d.tags){for(var b=d.tags.length-1;b>=0;b--){a=d.tags[b];if(a.indexOf("pfs:label")!==-1){var e=bcSfFilterTemplate.tagLabelHtml.replace(/{{labelTag}}/g,a.split("pfs:label-")[1]);c+=e;break}}}}return c}BCSfFilter.prototype.buildPagination=function(g){var e=parseInt(this.queryParams.page);var d=Math.ceil(g/this.queryParams.limit);if(d==1){jQ(this.selector.pagination).html("");return false}if(this.getSettingValue("general.paginationType")=="default"){var b=bcSfFilterTemplate.paginateHtml;var m=(e>1)?bcSfFilterTemplate.previousActiveHtml:bcSfFilterTemplate.previousDisabledHtml;m=m.replace(/{{itemUrl}}/g,this.buildToolbarLink("page",e,e-1));b=b.replace(/{{previous}}/g,m);var f=(e<d)?bcSfFilterTemplate.nextActiveHtml:bcSfFilterTemplate.nextDisabledHtml;f=f.replace(/{{itemUrl}}/g,this.buildToolbarLink("page",e,e+1));b=b.replace(/{{next}}/g,f);var i=[];for(var l=e-1;l>e-3&&l>0;l--){i.unshift(l)}if(e-4>0){i.unshift("...")}if(e-4>=0){i.unshift(1)}i.push(e);var c=[];for(var a=e+1;a<e+3&&a<=d;a++){c.push(a)}if(e+3<d){c.push("...")}if(e+3<=d){c.push(d)}var k="";var h=i.concat(c);for(var j=0;j<h.length;j++){if(h[j]=="..."){k+=bcSfFilterTemplate.pageItemRemainHtml}else{k+=(h[j]==e)?bcSfFilterTemplate.pageItemSelectedHtml:bcSfFilterTemplate.pageItemHtml}k=k.replace(/{{itemTitle}}/g,h[j]);k=k.replace(/{{itemUrl}}/g,this.buildToolbarLink("page",e,h[j]))}b=b.replace(/{{pageItems}}/g,k);jQ(this.selector.pagination).html(b)}};BCSfFilter.prototype.buildFilterSorting=function(){if(bcSfFilterConfig.custom.show_sorting&&bcSfFilterTemplate.hasOwnProperty("sortingHtml")){jQ(this.selector.topSorting).html("");var d=this.getSortingList();if(d){var a="";for(var b in d){a+='<option value="'+b+'">'+d[b]+"</option>"}var c=bcSfFilterTemplate.sortingHtml.replace(/{{sortingItems}}/g,a);jQ(this.selector.topSorting).html(c);jQ(this.selector.topSorting+" select").val(this.queryParams.sort)}}};BCSfFilter.prototype.buildFilterDisplayType=function(){var b="<span>"+bcSfFilterConfig.label.toolbar_viewas+"</span>";b+='<a href="'+this.buildToolbarLink("display","list","grid")+'" title="Grid view" class="bc-sf-filter-display-item bc-sf-filter-display-grid" data-view="grid"><span class="icon-fallback-text"><i class="fa fa-th" aria-hidden="true"></i><span class="fallback-text">Grid view</span></span></a>';b+='<a href="'+this.buildToolbarLink("display","grid","list")+'" title="List view" class="bc-sf-filter-display-item bc-sf-filter-display-list" data-view="list"><span class="icon-fallback-text"><i class="fa fa-list" aria-hidden="true"></i><span class="fallback-text">List view</span></span></a>';var c=jQ(this.getSelector("topDisplayType"));var a=jQ(this.getSelector("products"));c.html(b);c.find(".bc-sf-filter-display-item").removeClass("active");if(this.queryParams.display=="list"){c.find(".bc-sf-filter-display-list").addClass("active");a.removeClass("bc-sf-filter-grid-view-items").addClass("bc-sf-filter-list-view-items")}else{if(this.queryParams.display=="grid"){c.find(".bc-sf-filter-display-grid").addClass("active");a.removeClass("bc-sf-filter-list-view-items").addClass("bc-sf-filter-grid-view-items")}}};BCSfFilter.prototype.buildDisplayTypeEvent=function(){var c=this;var b=jQ(this.getSelector("topDisplayType"));var a=jQ(this.getSelector("products"));jQ(this.getSelector("topDisplayType")+" a").click(function(f){f.preventDefault();c.internalClick=true;jQ(this).parent().children().removeClass("active");jQ(this).addClass("active");if(c.queryParams.display=="list"){b.find(".bc-sf-filter-display-list").addClass("active");a.removeClass("bc-sf-filter-grid-view-items").addClass("bc-sf-filter-list-view-items")}else{if(c.queryParams.display=="grid"){b.find(".bc-sf-filter-display-grid").addClass("active");a.removeClass("bc-sf-filter-list-view-items").addClass("bc-sf-filter-grid-view-items")}}var d=jQ(this).attr("href");c.onChangeData(d,"display")})};BCSfFilter.prototype.buildFilterShowLimit=function(){if(bcSfFilterConfig.custom.show_limit&&bcSfFilterTemplate.hasOwnProperty("showLimitHtml")){jQ(this.selector.topShowLimit).html("");var e=this.getSettingValue("general.showLimitList");if(e!=""){var d="";var a=e.split(",");for(var b=0;b<a.length;b++){d+='<option value="'+a[b].trim()+'">'+a[b].trim()+"</option>"}var c=bcSfFilterTemplate.showLimitHtml.replace(/{{showLimitItems}}/g,d);jQ(this.selector.topShowLimit).html(c);jQ(this.selector.topShowLimit+" select").val(this.queryParams.limit)}}};BCSfFilter.prototype.buildBreadcrumb=function(d,c){if(bcSfFilterTemplate.hasOwnProperty("breadcrumbHtml")){var b="";if(typeof d!=="undefined"&&d.hasOwnProperty("collection")){var e=d.collection;if(typeof this.collectionTags!=="undefined"&&this.collectionTags!==null){b+=bcSfFilterTemplate.breadcrumbItemLink.replace(/{{itemLink}}/g,"/collections/"+e.handle).replace(/{{itemTitle}}/g,e.title);b+=" {{breadcrumbDivider}} ";b+=bcSfFilterTemplate.breadcrumbItemSelected.replace(/{{itemTitle}}/g,this.collectionTags[0])}else{b+=bcSfFilterTemplate.breadcrumbItemSelected.replace(/{{itemTitle}}/g,e.title)}}else{b+=bcSfFilterTemplate.breadcrumbItemSelected.replace(/{{itemTitle}}/g,this.getSettingValue("label.defaultCollectionHeader"))}var a=bcSfFilterTemplate.breadcrumbHtml.replace(/{{breadcrumbItems}}/g,b);a=a.replace(/{{breadcrumbDivider}}/g,bcSfFilterTemplate.breadcrumbDivider);jQ(this.selector.breadcrumb).html(a)}};function matchHeightImage(){jQ(".bc-sf-filter-product-item-main-image").load(function(){var a=jQ(this).parent();a.css("width","100%").css("height",$(this).height())}).each(function(){if(this.complete){jQ(this).load()}})}BCSfFilter.prototype.buildExtrasProductList=function(d,b){var a=this;var c=true;if(a.getSettingValue("actionlist.qvEnable")!=""||a.getSettingValue("actionlist.atcEnable")!=""){c=a.getSettingValue("actionlist.qvEnable")||a.getSettingValue("actionlist.atcEnable")}if(c===true&&typeof BCActionList!=="undefined"){if(typeof bcActionList==="undefined"){bcActionList=new BCActionList()}else{if(typeof bcAlParams!=="undefined"&&typeof bcSfFilterParams!=="undefined"){bcActionList.initFlag=false;bcActionList.alInit(bcSfFilterParams,bcAlParams)}else{bcActionList.alInit()}}}if(typeof theme!=="undefined"&&typeof theme.init==="function"){$(theme.init)}};BCSfFilter.prototype.buildAdditionalElements=function(c,a){var d=this;var b=c.total_product+"<span> "+bcSfFilterConfig.label.items_with_count_other+"</span>";if(c.total_product==1){b=c.total_product+"<span> "+bcSfFilterConfig.label.items_with_count_one+"</span>"}jQ("#bc-sf-filter-total-product").html(b);matchHeightImage();jQ(window).resize(function(){matchHeightImage()})};function buildDefaultLink(e,d){var f=window.location.href.split("?")[0];return f+="?"+e+"="+d}BCSfFilter.prototype.buildDefaultElements=function(L){if(bcSfFilterConfig.general.hasOwnProperty("collection_count")&&jQ("#bc-sf-filter-bottom-pagination").length>0){var K=bcSfFilterConfig.general.collection_count,J=parseInt(this.queryParams.page),I=Math.ceil(K/this.queryParams.limit);if(1==I){return jQ(this.selector.pagination).html(""),!1}if("default"==this.getSettingValue("general.paginationType")){var H=bcSfFilterTemplate.paginateHtml,G="";G=J>1?bcSfFilterTemplate.hasOwnProperty("previousActiveHtml")?bcSfFilterTemplate.previousActiveHtml:bcSfFilterTemplate.previousHtml:bcSfFilterTemplate.hasOwnProperty("previousDisabledHtml")?bcSfFilterTemplate.previousDisabledHtml:"",G=G.replace(/{{itemUrl}}/g,buildDefaultLink("page",J-1)),H=H.replace(/{{previous}}/g,G);var F="";F=J<I?bcSfFilterTemplate.hasOwnProperty("nextActiveHtml")?bcSfFilterTemplate.nextActiveHtml:bcSfFilterTemplate.nextHtml:bcSfFilterTemplate.hasOwnProperty("nextDisabledHtml")?bcSfFilterTemplate.nextDisabledHtml:"",F=F.replace(/{{itemUrl}}/g,buildDefaultLink("page",J+1)),H=H.replace(/{{next}}/g,F);for(var E=[],D=J-1;D>J-3&&D>0;D--){E.unshift(D)}J-4>0&&E.unshift("..."),J-4>=0&&E.unshift(1),E.push(J);for(var C=[],B=J+1;B<J+3&&B<=I;B++){C.push(B)}J+3<I&&C.push("..."),J+3<=I&&C.push(I);for(var A="",z=E.concat(C),y=0;y<z.length;y++){"..."==z[y]?A+=bcSfFilterTemplate.pageItemRemainHtml:A+=z[y]==J?bcSfFilterTemplate.pageItemSelectedHtml:bcSfFilterTemplate.pageItemHtml,A=A.replace(/{{itemTitle}}/g,z[y]),A=A.replace(/{{itemUrl}}/g,buildDefaultLink("page",z[y]))}H=H.replace(/{{pageItems}}/g,A),jQ(this.selector.pagination).html(H)}}if(bcSfFilterTemplate.hasOwnProperty("sortingHtml")&&jQ(this.selector.topSorting).length>0){jQ(this.selector.topSorting).html("");var x=this.getSortingList();if(x){var w="";for(var v in x){w+='<option value="'+v+'">'+x[v]+"</option>"}var u=bcSfFilterTemplate.sortingHtml.replace(/{{sortingItems}}/g,w);jQ(this.selector.topSorting).html(u);var t=void 0!==this.queryParams.sort_by?this.queryParams.sort_by:this.defaultSorting;jQ(this.selector.topSorting+" select").val(t),jQ(this.selector.topSorting+" select").change(function(b){window.location.href=buildDefaultLink("sort_by",jQ(this).val())})}}};BCSfFilter.prototype.prepareProductData=function(f){for(var c=0;c<f.length;c++){f[c]["images"]=f[c]["images_info"];if(f[c]["images"].length>0){f[c]["featured_image"]=f[c]["images"][0]}else{f[c]["featured_image"]={src:bcSfFilterConfig.general.no_image_url,width:"",height:"",aspect_ratio:0}}f[c]["url"]="/products/"+f[c].handle;var a=[];for(var g=0;g<f[c]["options_with_values"].length;g++){a.push(f[c]["options_with_values"][g]["name"])}f[c]["options"]=a;f[c]["price_min"]*=100,f[c]["price_max"]*=100,f[c]["compare_at_price_min"]*=100,f[c]["compare_at_price_max"]*=100;f[c]["price"]=f[c]["price_min"];f[c]["compare_at_price"]=f[c]["compare_at_price_min"];f[c]["price_varies"]=f[c]["price_min"]!=f[c]["price_max"];var l=f[c]["variants"][0];if(getParam("variant")!==null&&getParam("variant")!=""){var n=f.variants.filter(function(i){return i.id==getParam("variant")});if(typeof n[0]!=="undefined"){l=n[0]}}else{for(var g=0;g<f[c]["variants"].length;g++){if(f[c]["variants"][g].available){l=f[c]["variants"][g];break}}}f[c]["selected_or_first_available_variant"]=l;for(var g=0;g<f[c]["variants"].length;g++){var e=[];var h=1;var b=f[c]["variants"][g];var m=b.merged_options;if(Array.isArray(m)){for(var d=0;d<m.length;d++){var o=m[d].split(":");f[c]["variants"][g]["option"+(parseInt(d)+1)]=o[1];f[c]["variants"][g]["option_"+o[0]]=o[1];e.push(o[1])}f[c]["variants"][g]["options"]=e}f[c]["variants"][g]["compare_at_price"]=parseFloat(f[c]["variants"][g]["compare_at_price"])*100;f[c]["variants"][g]["price"]=parseFloat(f[c]["variants"][g]["price"])*100}f[c]["description"]=f[c]["content"]=f[c]["body_html"]}return f};